SHELL = @SHELL@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
sbindir = @sbindir@
includedir = @includedir@
libdir = @libdir@
libexecdir = @libexecdir@
srcdir = @srcdir@
sysconfdir = @sysconfdir@
mandir = @mandir@
datarootdir = @datarootdir@
localstatedir = @localstatedir@

CC = @CC@
CFLAGS = @CFLAGS@ @CPPFLAGS@
DEFS = @defs@
INCDIR = -I. -I../.. -I../../src @INCDIR@ @mysql_includes@
LIBDIR = -L. @LIBDIR@ @LDFLAGS@ -L../../src
LIBS = @LIBS@ @mysql_libs@
LDAP_LIBS = @ldap_libs@

CLAPF_USER = @CLAPF_USER@
CLAPF_GROUP = `@id_bin@ -gn $(CLAPF_USER)`

INSTALL = @INSTALL@

all:

install: @db_install@
	$(INSTALL) -m 0755 $(srcdir)/maillog.pl $(DESTDIR)$(libexecdir)/clapf
	$(INSTALL) -m 0644 $(srcdir)/history-purge-mysql.sql $(DESTDIR)$(datarootdir)/clapf
	$(INSTALL) -m 0644 $(srcdir)/history-purge-sqlite3.sql $(DESTDIR)$(datarootdir)/clapf
	$(INSTALL) -m 0644 $(srcdir)/mail.sql $(DESTDIR)$(datarootdir)/clapf

install-mysql-new:
	echo "please run $(DESTDIR)$(datarootdir)/clapf/mail.sql"


install-sqlite3:
	if [ ! -f "$(DESTDIR)$(localstatedir)/lib/clapf/stat/history.sdb" ]; then sqlite3 $(DESTDIR)$(localstatedir)/lib/clapf/stat/history.sdb < $(srcdir)/mail.sql; \
		chown -R $(CLAPF_USER):$(CLAPF_GROUP) $(DESTDIR)$(localstatedir)/lib/clapf/stat; fi


clean:

distclean: clean
	rm -f Makefile
