<html>
<title>User preferences</title>
<link rel="stylesheet" type="text/css" href="style.css">
<body bgcolor=white text=darkblue vlink=#AC003A>
<blockquote>

<h1><img src="logo.png"></h1>

<h2>User preferences</h2>

Clapf gives freedom to your users to set up their own preferences on what to do with
their incoming spam.<p>

The clapf utilities are able to retrieve user preferences from either an <a href="ldap.html">LDAP directory</a> or <a href="mysql.html">MySQL
database</a>. To use the personalised features of clapf you have to configure clapf either with
<strong>--with-userdb=ldap</strong> or <strong>--with-userdb=mysql</strong>.<br>

Look at the ldap/ directory and the user.sql file for examples how to set the user database.<p>

The clapf utilities read the email address of the users (<a href="spamquarantine.html">spam
quarantine</a> utilities use this) and the configured action to do with spam (for
passmail).<p>

The passmail utility can be used to handle incoming spam. It reads
the default configuration file (/usr/local/etc/clapf.conf) or the one
given as an argument, eg.

<pre>
/usr/local/bin/passmail /home/joe/passmail.conf
</pre>

To use passmail (and assuming you use maildrop) edit your ~/.mailfilter file,
and configure it to give every spam to passmail:<p>

<pre>
~joe/.mailfilter:

if(/^X-Clapf-spamicity: Yes/:h)
{
        to "|/usr/local/bin/passmail"
	#use a different config file:
	#to "|/usr/local/bin/passmail /home/joe/passmail.conf"
}
</pre>


The passmail utility is able to take 3 actions on your incoming spam:<p>

<ul>
<li>discard (=drop) - you won't notice marked spam at all (this is not recommended)
<li>move to your junk folder (if you have mbox format)
<li>move to your private spam quarantine (this is the default)
</ul>

Note that without the --with-userdb configure option passmail is only able to move your spam
into your spam quarantine.<p>

The usercgi utility is used for setting users' preferences. Copy it to your cgi-bin directory
and make it password protected.<p>

<pre>
cp usercgi /var/www/cgi-bin

/var/www/cgi-bin/.htaccess:

AuthUserFile /var/www/cgi-bin/.htpasswd
AuthName "clapf"
AuthType basic

require valid-user



/var/www/cgi-bin/.htpasswd:

username:&lt;encryptedpassword&gt;

</pre>

Online demo is available <a href="/cgi-bin/quarantine/usercgi">here</a>. (Login: test, pwd: test).<p>

<center><a href="index.html">home</a></center><p>


</blockquote>
</body></html>
