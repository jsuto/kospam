; This is an example config with default values
; Attention: do _not_ use whitespace between keys and values

; verbosity level. The more logging the greater load
; 1: normal
; 3: info
; 5: debug
verbosity=1

; SMTP HELO identification string
hostid=av-engine.localhost

; write pid file
pidfile=/var/lib/clapf/clapf.pid

; clapf will listen here
listen_addr=127.0.0.1
listen_port=10025

; where postfix is waiting for connections from clapf
postfix_addr=127.0.0.1
postfix_port=10026

; pass spam to this smtp server. If you have one computer set these variables
; to the same values as postfix_addr and postfix_port.
spam_smtp_addr=127.0.0.1
spam_smtp_port=10026

; where AVG's avgscan is waiting for us
avg_addr=127.0.0.1
avg_port=55555

; where avast! is waiting for us
avast_addr=127.0.0.1
avast_port=5036

; where Kaspersky's aveserver is waiting for us
kav_socket=/var/run/aveserver

; where Dr.Web is waiting for us
drweb_socket=/var/drweb/run/.daemon

; where clamd is waiting for us
clamd_socket=/tmp/clamd

; Qcache stuff

qcache_addr=127.0.0.1
qcache_port=48791
qcache_socket=/tmp/qcache
qcache_update=1

; how many seconds a child process is allowed to run before killed by force
; it should be greater than lmtp_connection_reuse_time_limit (300s by default)
session_timeout=420

; max. number of connections. This value should be greater than the max. number
; of connections postfix will make (by default 20) to clapf
max_connections=30

; the 2nd parameter of the listen() system call. Please note that this is set
; when clapf starts up and you should restart clapf if you change this variable.
; Please also note that the meaning of this variable depends on your Unix implementation
backlog=20

; uncomment this if you are using clamd and run clapf inside a chroot()'ed environment
; to let clapf pass the *real* path of the queue file to clamd. Thus you don't have
; to run clamd inside the jail. Do not forget the trailing '/'!
;chrootdir=/myjail/

; clapf puts its temporary files here
workdir=/var/lib/clapf/tmp

; uncomment to enable clapf to keep queue files for later inspection
; or for later training. If you enable this option do not forget to
; keep an eye on this directory and periodically remove aged files
; The workdir and the queuedir parameters must be on the same partition
; otherwise the link() function will not work
;queuedir=/var/lib/clapf/queue

; if this variable is set (it is not by default) clapf will
; move every virus infected message to this directory
quarantine_dir=

; edit the next two variables if you want to send notifications
; when a virus infected email arrives (this feature is disabled by default)

; the following addresses are the sender's and the recipient's email addresses
clapfemail=
localpostmaster=


; whether to return 550 error code and let the virus infected message
; bounced back (0), or send back a 250 ok code and drop the infected letter (1)
silently_discard_infected_email=1

; you may specify trap email addresses against DHA
;dha_trap_address_list=trap1@yourdomain trap2@yourdomain

;
; antispam stuff
;

; enable the anti-spam decision mechanism (1) or not (0)
; if you have not compiled anti-spam support don't care about this
use_antispam=1

; whether to use token pairs (1) or (not)
use_pairs=1
; whether to use single tokens (1) or (not)
use_single_tokens=1

; the minimum number of known phrases (token pairs and triplets),
; that can be used in the spamicity calculation.
; This is useful because we can have a greater belief in phrases than
; single words. Set to 0 to disable this feature.
min_phrase_number=20

; if the sender of the email (From: ...) has sent us at least 10
; good emails and 0 spam then whitelist his further emails. If he
; becomes a spammer just train his letter and he's removed from
; the automatic whitelist. use 0 to disable this feature.
enable_auto_white_list=1

; Robinson 's' and 'x' parameters
rob_s=1
rob_x=0.5

; effective size factor to help to handle the redundancy caused by
; overlapping tokens. By default both esf_h and esf_s are set to 1
; which means this feature is disabled. You might test what values
; are good for you
esf_h=1
esf_s=1

; The Spambayes and Bogofilter teams have pointed out that excluding the
; probabilities near 0.5 is useful. You may get rid of the neutral tokens
; with the exclusion radius. The default value (0.1) means that probabilities
; between 0.4-0.6 are excluded.
exclusion_radius=0.1

; skip spam test if the message size is greater than this value (in bytes)
; the default (0) means no such a limit
max_message_size_to_filter=65536

; whether to penalize the email containing images (1) or not (0).
; It may help you to fight image based spam. If set and finds an
; image, a special spammy token is created (IMAGE*). Only one IMAGE*
; token is created even if the message has multiple images.
penalize_images=0

; whether to add an additional penalty to emails having embedded images (1)
; or not (0). Embedded images has the src=cid:xxxxx sequence and pointing
; to the attached image. If set and finds an embedded image, a special
; spammy token is created (EMBED*). Only one EMBED* token is created
; even if the message has multiple images.
penalize_embed_images=0

; a similar directive like 'penalize_images', except this one cares about
; octet stream attachments. If enabled (1) it may help you to fight PDF spam.
penalize_octet_stream=0

; if the message has an embedded image _and_ its spamicity value is _above_
; max_ham_spamicity (see below), the message is marked as spam

; SURBL domain. It's a kind of RBL list. URLs in the incoming messages
; can be checked against the SURBL database. If found a special spammy
; token is created thus the overall spamicity will be higher
; I know another domain - multi.uribl.com - you may use as well as your
; own rbl domain if you have any. You may query multiply RBL lists by
; a comma separated list of domains, like
; surbl_domain=multi.surbl.org,multi.uribl.com,uris.yourdomain.name.here
surbl_domain=multi.surbl.org

; if clapf is unsure about the message (ie. its spamicity is above the
; max_ham_spamicity and below the spam_overall_limit), it will query
; the given RBL lists, and if the sending host is found on them, clapf
; will mark the message as spam. Uncomment this if you want to disable
; this feature.
rbl_domain=cbl.abuseat.org

; clapf counts how many URLs the surbl code catches. Each match in the
; surbl domain(s) counts. So if you have a bad URL and you have 2 surbl
; domains and this bad URL is on both surbl domains then it takes 2.
; If this value is set and if clapf gets at least this number of URL
; matches than this AND the spamicity of the message is greater than
; max_ham_spamicity than the message is marked as spam
rude_surbl=0

; custom header field inserted into the message. Note the trailing space!
clapf_header_field=X-Clapf-spamicity: 

; custom header line to insert to spam messages
; Format: <header name>: <value>
clapf_spam_header_field=X-Clapf-spamicity: Yes

; You may define additional header fields to help "less advanced" mailer
; applications, eg. Outlook Express to recognise spam. If your users use
; OE you may use the following fields. For more information, see
; http://wiki.apache.org/spamassassin/OeFilter.
; If you want OE compatibility uncomment the following lines:
;clapf_spam_header_field=X-Priority: 5
;clapf_spam_header_field=Priority: Non-Urgent
;clapf_spam_header_field=Importance: low
;clapf_spam_header_field=X-MSMail-Priority: Low

; put this prefix to the Subject: line if the message is spam
; note the trailing space!
spam_subject_prefix=[sp@m] 

; the message is marked as spam if its spamicity value is above this limit
; actually this can be anywhere above 0.9. If your ham-spam data is good
; your spamicity values are expected around 0.001 and 0.999.
; You may try as low as 0.9
spam_overall_limit=0.92

; a ham message has at most this high spam probability
max_ham_spamicity=0.39

; if the spamicity of the message exceeds this threshold clapf will
; reject the message. Please note that the default value is greater
; than 1, so clapf will _not_ drop spam. If you set it to a lower
; value (eg. 0.99) clapf will reject emails with spamicity at least
; 0.99 (>=99% probability of spam).
; This feature can be useful on smtp relays where you want to eliminate
; _outgoing_ spam. I would not recommend to use it on your incoming
; MX hosts as it may result losing a legitimate email (though very
; rarely)
spaminess_oblivion_limit=1.01

; some email has a spamicity value around 0.5, so we know nothing sure about it.
; A few spams are just below the spam_overall_limit limit. In this case we calculate
; the spamicity value from the single token table too. Then let's compare their
; deviation and choose the one with greater deviation.
;
; The next to variables determine in what cases to apply this behaviour.
; If the spamicity value is around 0.5 (+/- min_deviation_to_use_single_tokens)
; or the spamicity is between use_single_tokens_min_limit and spam_overall_limit
;
; If you want to disable this behaviour set the following:
; use_single_tokens_min_limit=1
; min_deviation_to_use_single_tokens=0
use_single_tokens_min_limit=0.85
min_deviation_to_use_single_tokens=0.1

spaminess_of_strange_language_stuff=0.9876
spaminess_of_too_much_spam_in_top15=0.9998
spaminess_of_blackholed_mail=0.9995
spaminess_of_caught_by_surbl=0.9997
spaminess_of_embed_image=0.9994

; if this value is set (it is by default) mark messages
; having base64 encoded textual parts as spam regardless
; of their actual spamicity score. Set to 0 to disable
; this feature
spaminess_of_text_and_base64=0.9996

; whether to use (1) or nt (0) all the most interesting tokens if we have
; more than 15.
use_all_the_most_interesting_tokens=1

; if the ratio of spammy tokens / all the tokens in the top10
; exceeds this limit mark the message as spam. This is useful to catch
; such a spam where it contains a lot of spam tokens as well as a few
; ham tokens thus the overall spamicity score is not high enough to
; mark the whole message as spam. Set to 0 to disable this feature.
spam_ratio_in_top10=0.9

; uncomment the blackhole_path variable to enable the blackhole feature
;blackhole_path=/var/lib/clapf/blackhole
;blackhole_email_list=


; a group may be either shared (0) or merged (1). A shared group is useful
; when all the users have similar email patterns. The merged group consists
; of a global database (with uid=0) and all users may train the token database
; with their own data. Clapf will then merge these two datasets at run time.
; You may achieve greater accuracy while personal data requires more space
group_type=1

; the training mode may be either Train On Error (0) or Train Until Mature (1)
; Users may train the token database (only) when an error occurs (=TOE). With
; TUM mode, however, clapf will automatically trains those tokens not mature
; enough (ie. having less then 50 hits in the token table). Though TUM has
; a shorter learning curve, but it produces more tokens in the database, so
; it will be larger than with TOE.
training_mode=0


; enable this (by setting to 1) if you do not want to perform an initial training
; and let clapf autolearn the first 1000 ham and spam messgaes. Of course you
; have to correct its training errors. By default you are expected to do an
; initial training
initial_1000_learning=0


; whether to store the email with some metadata to the database (1) or not (0)
; by default we store the email for later training
store_metadata=1

; whether to store only spam emails (1) or not (0). It is only affected if
; store_metadata=1
store_only_spam=0

;
; foreign language stuff
;

; if the number of invalid characters (look ijc.h) reach this limit
; mark the message as spam. Set to 0 to disable this feature
invalid_junk_limit=5

; if the number of lines in a strange language reach this limit
; mark the message as spam. Set to 0 to disable this feature
invalid_junk_line=1

; if the number of invalid hexa characters (=xx) reach this limit
; mark the message as spam. Set to 0 to disable this feature
invalid_hex_junk_limit=40

;
; libclamav stuff
;

; whether to mark archives as viruses (1) or not (0) if maxfiles,
; maxfilesize, or maxreclevel limit is reached.
use_libclamav_block_max_feature=1

; max. number of files scanned within the archive
clamav_maxfile=100

; archived files larger than this value will not be scanned
clamav_max_archived_file_size=31457280

clamav_max_recursion_level=5
clamav_max_compress_ratio=200

; memory limit for bzip2 scanner, can be either 0 (disable) or 1 (enable)
clamav_archive_mem_limit=0

; whether to treat encrypyed archives as a virus (1) or not (0)
clamav_block_encrypted_archives=1

; whether to load the phishing database (1) or not (0)
clamav_use_phishing_db=1

;
; mysql stuff
;

;mysqlhost=127.0.0.1
;mysqlport=3306
mysqlsocket=/tmp/mysql.sock
mysqluser=clapf
mysqlpwd=changeme
mysqldb=clapf
mysql_connect_timeout=2

;
; sqlite3 stuff
;

sqlite3=/var/lib/clapf/data/tokens.sdb

; set sqlite3 pragma, see http://www.sqlite.org/pragma.html for more details
; possible values are:
; PRAGMA synchronous = FULL
; PRAGMA synchronous = NORMAL
; PRAGMA synchronous = OFF
sqlite3_pragma=PRAGMA synchronous = OFF


; mydb stuff
mydbfile=/var/lib/clapf/tokens.mydb


;
; web stuff
;

; you will be relocated in X seconds after training the sql database
relocate_delay=5

; this is the URI where you are sent after training the database
relocate_url=http://www.yourdomain.com/clapftraining/index.html

; the url of the spam quarantine handler cgi utility
spamcgi_url=http://www.yourdomain.com/cgi-bin/spamcgi

; the url of the training cgi utility
traincgi_url=http://www.yourdomain.com/cgi-bin/traincgi

; the url of the trainlogcgi utility
trainlogcgi_url=http://www.yourdomain.com/cgi-bin/trainlogcgi

; the url of the usercgi utility
usercgi_url=http://www.yourdomain.com/cgi-bin/usercgi

; the url of the statcgi utility
statcgi_url=http://www.yourdomain.com/cgi-bin/statcgi

; how many spam messages to show in a single page
page_len=25

; whether the traincgi utility should save the trained messages (1) or not (0)
;save_trained_emails=0


;
; spam quarantine stuff
;

; used in the MAIL FROM: SMTP command when the user wants a message
; marked as spam to be delivered
spam_mail_from=spamquarantine@yourdomain.com

;
; ldap stuff
;
; (don't care the ldap stuff unless you compiled with -DHAVE_LDAP)
; and you want delivery feature from the spam quarantine

; IP-address of the ldap server
ldap_host=

; ldap base dn, eg. ou=users,o=yourdomain,dc=yourdomain,dc=com
ldap_base=

; bind dn and password for connecting to the ldap server.
; You are connecting as anonymous unless use set these values
ldap_user=
ldap_pwd=

; whether you want secure (tls) connections to the ldap server
; If yes then you should add "TLS_REQCERT allow" to ldap.conf
ldap_use_tls=0
