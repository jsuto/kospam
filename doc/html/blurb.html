<html>
<title>clapf promotion blurb</title>
<link rel="stylesheet" type="text/css" href="style.css">
<body bgcolor=white text=darkblue vlink=#AC003A>
<blockquote>

<h1><img src="logo.png"></h1>

<h2>clapf promotion blurb</h2>

<strong>What is clapf?</strong><p>

Clapf is an <a href="http://dev.acts.hu/os/">open-source</a> spam filter application published under the 
<a href="http://www.opensource.org/licenses/zlib-license.php">zlib/png license</a>.
It is designed to be fast, simple and easy to use.<br>
It talks via the SMTP protocol with postfix (or any other MTA capable for this kind of communication)
and can use <a href="http://www.clamav.net/">libclamav</a>, <a href="http://free.grisoft.com/">AVG Linux</a>,
<a href="http://www.avast.com/">avast!</a>, <a href="http://www.kaspersky.com/">Kaspersky</a> or
<a href="http://www.drweb.com/">Dr.Web</a> to prevent virus infected emails
getting in your network.<p>



<strong>Features</strong><p>

<pre>
network based operation
Bayesian-like (inverse chi-square) statistic filter
99% (or even better) accuracy
very little false positives rate
never rejects an email unless it's virus infected
character set recognition
simple and easy to use database training
blackhole feature
URI blacklist support
utf8, base64 and quoted-printable decoder
limit the size of messages to be filtered
low total cost of ownership (TCO)
</pre>

<p>

<strong>How it works</strong><p>

Configure your MTA to forward each incoming message to clapf. The filter checks whether it
contains a virus. If it does clapf rejects the message with "550 Access denied. (virusname)"
and it's over.<p>

If the message looks cleans and you have compiled antispam support and enabled this feature
in the configuration file (this is the default) clapf runs a Bayesian test on the textual
part(s) of the email.<p>

Clapf reads the token probabilities from a CDB file. It creates token pairs as well as
single tokens from URLs. 
Then clapf selects the most interesting tokens and calculates an overall spamicity value.
If this value is above a certain (configurable) threshold it marks the message as spam.<p>

The filter never rejects a message even if it is spam unless it is virus infected. Of course
you have the freedom to modify the source code and achieve this behaviour but I don't
recommend it.<p>

Clapf inserts some special header fields (of course its name is configurable) to the email
containing the message identifier clapf has generated, the spam probability and if the
message is considered spam clapf also put a fixed string into the header for the easy
spam recognition in procmail, maildrop, ...<p>

Then it sends the message back to postfix let it deliver the letter to the user's mailbox.<p>

The filter syslogs a few parameters about the message for statistics: the message identifier,
the spamicity value, message length and the time took to handle the message.<p>


<strong>Database training</strong><p>

Every statitical (eg. Bayesian) filter must be trained. Clapf uses the CDB format to read token probabilities
from. Unfortunately this format is constant ie. read only, but when the filter makes a
mistake it should be trained. The administrator may recreate the CDB file from scratch
or put the tokens into a MySQL database then let the users train it via a very simple
form and let a cron job refresh the CDB file if necessary.<p>


<strong>Blackhole feature</strong><p>

This feature is able to make the filter even better especially if you have a lot of email
addresses. Create a trap email address what you advertise in web pages, news groups,
irc channels, etc. Chances are that spammers will find it and send their bulk messages
to this address.<p>

You may create eg. a maildrop rule to run a special script (included in the source
distribution) which extracts the address of the computer connecting to you then put this IP-address
into a (currently MySQL) database. If you compiled and activated the blackhole feature
every incoming message is searched for the trapped IP-addresses. If one of them is
found the analysed message is obviously spam and can be marked without further investigation.<p>

This is actually a kind of (automatic) black list. It can work without human interaction: a cron
job can purge aged entries from the database lowering the TCO.<p>

<strong>URI blacklist</strong><p>

This feature checks every URI in the message against a (public or private) DNS blacklist. If an URI.rbldomain
host can be resolved chances are that the whole message is spam. For minimising false positives clapf creates
a special single session token added to the token list increasing the spam probability of the message.<p>

I tried <a href="http://www.surbl.org/">SURBL</a> and <a href="http://www.uribl.com/index.shtml">uribl</a>.<p>

<strong>Other smart features</strong><p>

A typical spam is only a few kB in size. To save processing resources clapf can be configured to
pass messages above a certain configurable limit without antispam check.<p>

If you are getting a lot of Asian, ... spam in an undisplayable language
just fill a customisable array and let clapf counts these characters in each
incoming message. If their number exceeds a certain limit the filter can mark the
message as spam.<p>


<strong>The numbers</strong><p>

No blurb is complete without the impressive numbers. I did a 2 week long test and got 1245
messages. Clapf caught 630 of 633 spam (99.52%) with no false positives (612 of 612 ham = 100%).
The overall accuracy is <strong>99.75%</strong> (1242 of 1245). After your token database is
created you may achieve this level of accuracy or even better.<p>

Clapf is able to handle my average size (<10 kB) messages within 20-30 msec (without the
blackhole feature).<p>

<a name="ss11">
<strong>Statistics</strong><p>
</a>

With rrdtool you can create any number of impressive reports.

These are some example reports showing my spam in a month:<p>

<img src="ham-spam.png">
<img src="spam-ratio.png"><p>
<img src="spam-size.png"><p>



<strong>Future</strong><p>

Per user token database association is planned with MySQL or LDAP.
<p>


<center><a href="index.html">home</a></center><p>

</blockquote>
</body></html>
