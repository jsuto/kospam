<html>
<title>Training the token database</title>
<link rel="stylesheet" type="text/css" href="style.css">
<body bgcolor=white text=darkblue vlink=#AC003A>
<blockquote>

<h1><img src="logo.png"></h1>

<h2>Further training</h2>

Besides forwarding an email, clapf can be trained in two additional ways.
Administrators and shell users may use a command line utility, the other
users may use a cgi form.<p/>


<strong>Using the command line</strong><p/>

Usage:<p>

train -c &lt;config file&gt; [ -S &lt;spam message file&gt; | -H &lt;ham message file&gt; ] [ -u &lt;uid&gt; ] <p>

If you want to train the global database with a spam message:<p>

<pre>
train -c /usr/local/etc/clapf.conf -S message
</pre>

And similarly with a ham message:<p>

<pre>
train -c /usr/local/etc/clapf.conf -H message
</pre>

Train with a spam message as a user with uid=1000:

<pre>
train -c /usr/local/etc/clapf.conf -S message -u 1000
</pre>


<strong>Setting up the cgi form</strong><p/>

I assume you have a working web server (such as Apache).<p/>

Create a directory (or a separate virtual host) and put TRAINING/index.html there.
It contains a simple form with a select menu (ham or spam) and a textarea field
to hold the message.<p/>

<pre>
mkdir /var/www/html/train
cp TRAINING/index.html /var/www/html/train
</pre>

(Re)compile clapf with --enable-cgi option then put the file called traincgi
to your cgi-bin directory. I strongly recommend you to put some access control
at least to the traincgi program eg. a login/password protection.<p/>

<pre>
cp traincgi /var/www/cgi-bin
vi /var/www/cgi-bin/.htaccess
vi /var/www/cgi-bin/.htpasswd
</pre>

The traincgi program reads the configuration file of clapf (by default: /usr/local/etc/clapf.conf)
for the mysql account parameters and the url of the training site. I strongly
recommend you to remove world read permission from the configuration file let only
the web server and the user running clapf read this file.<p/>

If you are using an SQLite3 token database set proper file permissions.<p/>

<strong>Using the CGI interface</strong><p/>

<ol>
<li>user visits and authenticates himself at the web site</li>

<li>Assuming Thunderbird (an excellent MUA application), the user
issues the following key-combinations:<p>

<pre>
CTRL + u: show the source of the message
CTRL + a: select the whole message
CTRL + c: copy the selected stuff
</pre></li>

<li>User pastes the selection with (CTRL + v) to the textarea field then selects
that this message is either ham or spam, then clicks on the submit button.


<center><a href="index.html">home</a></center><p>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1610427-1";
urchinTracker();
</script>


</blockquote>
</body></html>
